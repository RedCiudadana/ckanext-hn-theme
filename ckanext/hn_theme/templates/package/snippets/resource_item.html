
{% set can_edit = h.check_access('package_update', {'id':pkg.id }) %}
{% set url_action = 'resource_edit' if url_is_edit and can_edit else 'resource_read' %}
{% set url = h.url_for('resource.read', id=pkg.name, resource_id=res.id) %}

<tr data-id="{{ res.id }}">
    {# 1. Ícono con enlace a metadatos #}
    <td class="text-center align-middle">
        <a href="{{ h.url_for(controller='package', action='resource_read', id=pkg.name, resource_id=res.id) }}"
           class="heading d-inline-block"
           title="Ver metadatos: {{ res.name or res.description }}"
           style="text-decoration: none;">
            <span class="format-label"
                  property="dc:format"
                  data-format="{{ res.format.lower() or 'data' }}"
                  style="display: inline-block; min-width: 50px;">
                {{ h.get_translated(res, 'format') or _('data') }}
            </span>
        </a>
    </td>

    {# 2. Descripción (nombre + descripción) #}
    <td class="align-middle">
        <strong>{{ res.get('name') or _('Sin título') }}</strong>
        {% if res.get('description') %}
        <br><small class="text-muted">{{ res.description | truncate(120) }}</small>
        {% endif %}
    </td>

    {# 3. Acciones: Descargar + Metadatos #}
    <td class="align-middle">
        <div class="btn-group btn-group-sm" role="group">
            {# Botón: Descargar #}
           
        </div>
    </td>
</tr>