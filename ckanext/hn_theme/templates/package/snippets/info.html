{#
Displays a sidebar module with information for given package

pkg          - The package dict that owns the resources.
am_following - True if the user is following the package.

Example:

  {% snippet "package/snippets/info.html", pkg=pkg, am_following=am_following %}

#}
{% block package_info %}
  {% if pkg %}
<section id="package-info" class="module module-narrow">
    <div class="module context-info">
        <div class="module-content">
            {% block package_info_inner %}

            {# --- Intenta obtener la organización de forma segura --- #}
            {% set org = c.group_dict if c.group_dict else (pkg.organization if pkg.organization else none) %}

            {% if org %}
            <div class="col-12">
                {% block image %}
                <div class="image text-center mb-3">
                    <a href="{{ h.url_for('organization.read', id=org.name) }}">
                        <img src="{{ org.image_display_url or h.url_for_static('/base/images/placeholder-organization.png') }}"
                             style="width: 60%; max-width: 120px; height: auto;"
                             alt="{{ org.title or org.name }}" />
                    </a>
                </div>
                {% endblock %}
            </div>
            <div class="col-12 text-center mb-3">
                {% block heading %}
                <h1 class="heading">{{ h.dataset_display_name(pkg) }}</h1>
                <span style="font-size: 17px;">
                    {{ org.title or org.name }}
                    {% if org.state == 'deleted' %}
                    [{{ _('Deleted') }}]
                    {% endif %}
                </span>
                {% endblock %}
            </div>
            {% else %}
            {# --- Si no hay organización, muestra solo el título del dataset --- #}
            <div class="col-12 text-center mb-3">
                <h1 class="heading">{{ h.dataset_display_name(pkg) }}</h1>
            </div>
            {% endif %}

            {# --- Notas del dataset (siempre visible) --- #}
            {% if pkg.notes %}
            <div class="col-12">
                <div class="mt-3 mb-2">
                    <strong>Sobre estos datos</strong>
                </div>
                <p style="text-align: justify;">
                    {{ h.markdown_extract(pkg.notes, 200) }}
                </p>
            </div>
            {% endif %}

            {% endblock %}
        </div>
    </div>
</section>
  {% endif %}
{% endblock %}