{# 
Renders a list of resources with icons and view links.

resources - A list of resources to render
pkg - A package object that the resources belong to.

Example:

  {% snippet "package/snippets/resources_list.html", pkg=pkg, resources=pkg.resources %}

#}

<section id="dataset-resources" class="resources">
  <h3>Descargas</h3>

  {% if resources %}
    <ul class="resource-list">
      {% for res in resources %}
        {% set can_edit = h.check_access('package_update', {'id': pkg.id }) %}
        {% set url_action = 'resource_edit' if url_is_edit and can_edit else 'resource_read' %}
        {% set url = h.url_for(controller='package', action=url_action, id=pkg.name, resource_id=res.id) %}
        
        <li class="resource-item" data-id="{{ res.id }}">
          <a class="heading" href="{{ url }}" title="{{ res.name or res.description }}">
            {{ h.resource_display_name(res) | truncate(50) }}
            <span class="format-label" property="dc:format" data-format="{{ res.format.lower() or 'data' }}">
              {{ h.get_translated(res, 'format') }}
            </span>
            {{ h.popular('views', res.tracking_summary.total, min=10) }}
          </a>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    {% if h.check_access('resource_create', {'package_id': pkg['id']}) %}
      {% trans url=h.url_for(controller='package', action='new_resource', id=pkg.name) %}
        <p class="empty">Este conjunto de datos no tiene recursos. <a href="{{ url }}">Â¿Deseas agregar uno?</a></p>
      {% endtrans %}
    {% else %}
      <p class="empty">Este conjunto de datos no tiene recursos.</p>
    {% endif %}
  {% endif %}
</section>
