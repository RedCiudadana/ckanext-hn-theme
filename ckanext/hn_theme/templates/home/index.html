{% extends "page.html" %}

{% block subtitle %}{{ _("Welcome") }}{% endblock %}

{% block maintag %}{% endblock %}
{% block toolbar %}{% endblock %}

{% block content %}
<div class="homepage">
    <div id="content" class="container">
        {{ self.flash() }}
    </div>

    {% block primary_content %}
    <div role="main">

        <!-- üîπ Secci√≥n 1: B√∫squeda (sin cambios) -->
        <div class="main hero">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        {% block search %}
                        {% snippet 'home/snippets/search.html', search_facets=search_facets %}
                        {% endblock %}
                    </div>
                </div>
            </div>
        </div>

        <!-- üîπ Secci√≥n 2: Banner flotante (¬øQu√© son?, Disponibles, Eventos) -->
        <div class="section-block bg-light py-5">
            <div class="container">
                <div class="floating-banner shadow rounded-3 overflow-hidden">
                    <div class="row g-0">
                        {% for item in [
                        {
                        'img': '/img/datos-1.png',
                        'title': _('¬øQu√© son los datos abiertos?'),
                        'url': '/pages/datos-abiertos',
                        'text': _('Los datos abiertos son informaci√≥n p√∫blica digital, accesible, reutilizable y libre de restricciones legales o t√©cnicas.'),
                        'target': '_blank'
                        },
                        {
                        'img': '/img/datos-2.png',
                        'title': _('Datos abiertos disponibles.'),
                        'url': h.url_for('dashboard.datasets'),
                        'text': _('Explora, descarga y reutiliza datos p√∫blicos para generar conocimiento, innovaci√≥n y transparencia.'),
                        'target': '_self'
                        },
                        {
                        'img': '/img/datos-3.png',
                        'title': _('Eventos de datos abiertos.'),
                        'url': '/pages/eventos',
                        'text': _('Promovemos el di√°logo, el aprendizaje y la colaboraci√≥n en torno a los datos abiertos.'),
                        'target': '_blank'
                        }
                        ] %}
                        <div class="col-12 col-md-4 border-end">
                            <div class="p-4 text-center h-100 d-flex flex-column justify-content-center">
                                <img src="{{ item.img }}" alt="" class="mx-auto mb-3" style="max-height: 80px; width: auto;">
                                <div>
                                    <a href="{{ item.url }}" target="{{ item.target }}" class="text-decoration-none">
                                        <h3 class="h5">{{ item.title }}</h3>
                                    </a>
                                    <p class="text-muted mb-0">{{ item.text }}</p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <!-- üîπ Secci√≥n 3: Categor√≠as de datos (featured_group) -->
        <div class="section-block py-5">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h2 class="text-center fs-2 mb-4">{{ _('Categor√≠as de datos') }}</h2>
                        {% block featured_group %}
                        {% snippet 'home/snippets/featured_group.html' %}
                        {% endblock %}
                    </div>
                </div>
            </div>
        </div>

        <!-- üîπ Secci√≥n 4: Novedades (blog) -->
        {% set blogs = h.get_recent_blog_posts(number=4) %}
        {% if blogs %}
        <div class="section-block bg-light py-5">
            <div class="container">
                <div class="row">
                    <div class="col-12 text-center">
                        <h2 class="fs-2 mb-4">{{ _('Novedades') }}</h2>
                        <div class="page-list">
                            <div class="row g-4">
                                {% for post in blogs %}
                                <div class="col-md-3">
                                    <div class="card h-100 shadow-sm text-start">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title h5">
                                                <a href="{{ h.url_for('pages.blog_show', page='' + post.name) }}" class="text-dark text-decoration-none">
                                                    {{ post.title or post.name }}
                                                </a>
                                            </h3>
                                            <div class="card-text mb-3 flex-grow-1">
                                                {{ h.markdown_extract(post.content, 100) }}
                                            </div>
                                            {% if post.publish_date %}
                                            <a href="{{ h.url_for('pages.blog_show', page='/' + post.name) }}" class="mt-auto text-decoration-underline">
                                                {{ _('Leer m√°s') }} <i class="fa fa-arrow-right ms-1"></i>
                                            </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

    </div>
    {% endblock %}
</div>
{% endblock %}